"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),w=require("../../context/ThemeModeContext.js"),o=require("../../utils/matchBrowserPrefers.js"),T=require("../../utils/safeStartTransition.js"),v=require("../../utils/useMergeValue.js");let n;const B=t.defineComponent(e=>{const r=()=>{o.matchBrowserPrefers("dark").matches?e.setAppearance("dark"):e.setAppearance("light")},u=()=>{o.matchBrowserPrefers("dark").matches?e.setBrowserPrefers("dark"):e.setBrowserPrefers("light")};return t.watchEffect(()=>{if(e.themeMode!=="auto"){T.safeStartTransition(()=>{e.setAppearance(e.themeMode)});return}setTimeout(r,1),n||(n=o.matchBrowserPrefers("dark")),r&&n.removeEventListener("change",r),n.addEventListener("change",r)}),t.watchEffect(()=>{n||(n=o.matchBrowserPrefers("dark")),u&&n.removeEventListener("change",u),n.addEventListener("change",u)}),t.onBeforeUnmount(()=>{n.removeEventListener("change",r)}),()=>null},{props:["themeMode","setAppearance","setBrowserPrefers"]}),P=t.defineComponent((e,r)=>{var f;const u=e.useTheme(),h=t.shallowRef((f=o.matchBrowserPrefers("dark"))!=null&&f.matches?"dark":"light"),M=s=>{h.value=s},c=t.shallowRef();t.onMounted(()=>{c.value=!0});const[d,g]=v.useMergeValue("light",{value:t.computed(()=>e.themeMode),defaultValue:(e==null?void 0:e.defaultThemeMode)??t.unref(u.value.themeMode),onChange:s=>{var a;return(a=e==null?void 0:e.onThemeModeChange)==null?void 0:a.call(e,s)}}),[l,m]=v.useMergeValue("light",{value:t.computed(()=>e.appearance),defaultValue:e.defaultAppearance??t.unref(u.value.appearance),onChange:s=>{var a;return(a=e.onAppearanceChange)==null?void 0:a.call(e,s)}});return w.useThemeModeProvide({appearance:l,setAppearance:m,themeMode:d,setThemeMode:g,isDarkMode:t.computed(()=>l.value==="dark"),browserPrefers:h}),()=>{var a,i;const s=(i=(a=r==null?void 0:r.slots)==null?void 0:a.default)==null?void 0:i.call(a);return t.createVNode(t.Fragment,null,[c.value&&t.createVNode(B,{themeMode:d.value,setAppearance:m,setBrowserPrefers:M},null),s])}},{props:["appearance","defaultAppearance","onAppearanceChange","themeMode","defaultThemeMode","onThemeModeChange","useTheme"]});exports.default=P;
