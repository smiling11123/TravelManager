{"version":3,"file":"mbox-D-h-2fuj.js","names":["header"],"sources":["../../@codemirror/legacy-modes/mode/mbox.js"],"sourcesContent":["var rfc2822 = [\n  \"From\", \"Sender\", \"Reply-To\", \"To\", \"Cc\", \"Bcc\", \"Message-ID\",\n  \"In-Reply-To\", \"References\", \"Resent-From\", \"Resent-Sender\", \"Resent-To\",\n  \"Resent-Cc\", \"Resent-Bcc\", \"Resent-Message-ID\", \"Return-Path\", \"Received\"\n];\nvar rfc2822NoEmail = [\n  \"Date\", \"Subject\", \"Comments\", \"Keywords\", \"Resent-Date\"\n];\n\nvar whitespace = /^[ \\t]/;\nvar separator = /^From /; // See RFC 4155\nvar rfc2822Header = new RegExp(\"^(\" + rfc2822.join(\"|\") + \"): \");\nvar rfc2822HeaderNoEmail = new RegExp(\"^(\" + rfc2822NoEmail.join(\"|\") + \"): \");\nvar header = /^[^:]+:/; // Optional fields defined in RFC 2822\nvar email = /^[^ ]+@[^ ]+/;\nvar untilEmail = /^.*?(?=[^ ]+?@[^ ]+)/;\nvar bracketedEmail = /^<.*?>/;\nvar untilBracketedEmail = /^.*?(?=<.*>)/;\n\nfunction styleForHeader(header) {\n  if (header === \"Subject\") return \"header\";\n  return \"string\";\n}\n\nfunction readToken(stream, state) {\n  if (stream.sol()) {\n    // From last line\n    state.inSeparator = false;\n    if (state.inHeader && stream.match(whitespace)) {\n      // Header folding\n      return null;\n    } else {\n      state.inHeader = false;\n      state.header = null;\n    }\n\n    if (stream.match(separator)) {\n      state.inHeaders = true;\n      state.inSeparator = true;\n      return \"atom\";\n    }\n\n    var match;\n    var emailPermitted = false;\n    if ((match = stream.match(rfc2822HeaderNoEmail)) ||\n        (emailPermitted = true) && (match = stream.match(rfc2822Header))) {\n      state.inHeaders = true;\n      state.inHeader = true;\n      state.emailPermitted = emailPermitted;\n      state.header = match[1];\n      return \"atom\";\n    }\n\n    // Use vim's heuristics: recognize custom headers only if the line is in a\n    // block of legitimate headers.\n    if (state.inHeaders && (match = stream.match(header))) {\n      state.inHeader = true;\n      state.emailPermitted = true;\n      state.header = match[1];\n      return \"atom\";\n    }\n\n    state.inHeaders = false;\n    stream.skipToEnd();\n    return null;\n  }\n\n  if (state.inSeparator) {\n    if (stream.match(email)) return \"link\";\n    if (stream.match(untilEmail)) return \"atom\";\n    stream.skipToEnd();\n    return \"atom\";\n  }\n\n  if (state.inHeader) {\n    var style = styleForHeader(state.header);\n\n    if (state.emailPermitted) {\n      if (stream.match(bracketedEmail)) return style + \" link\";\n      if (stream.match(untilBracketedEmail)) return style;\n    }\n    stream.skipToEnd();\n    return style;\n  }\n\n  stream.skipToEnd();\n  return null;\n};\n\nexport const mbox = {\n  name: \"mbox\",\n  startState: function() {\n    return {\n      // Is in a mbox separator\n      inSeparator: false,\n      // Is in a mail header\n      inHeader: false,\n      // If bracketed email is permitted. Only applicable when inHeader\n      emailPermitted: false,\n      // Name of current header\n      header: null,\n      // Is in a region of mail headers\n      inHeaders: false\n    };\n  },\n  token: readToken,\n  blankLine: function(state) {\n    state.inHeaders = state.inSeparator = state.inHeader = false;\n  },\n  languageData: {\n    autocomplete: rfc2822.concat(rfc2822NoEmail)\n  }\n}\n\n"],"mappings":";AAAA,IAAI,UAAU;CACZ;CAAQ;CAAU;CAAY;CAAM;CAAM;CAAO;CACjD;CAAe;CAAc;CAAe;CAAiB;CAC7D;CAAa;CAAc;CAAqB;CAAe;CAChE;AACD,IAAI,iBAAiB;CACnB;CAAQ;CAAW;CAAY;CAAY;CAC5C;AAED,IAAI,aAAa;AACjB,IAAI,YAAY;AAChB,IAAI,gCAAgB,IAAI,OAAO,OAAO,QAAQ,KAAK,IAAI,GAAG,MAAM;AAChE,IAAI,uCAAuB,IAAI,OAAO,OAAO,eAAe,KAAK,IAAI,GAAG,MAAM;AAC9E,IAAI,SAAS;AACb,IAAI,QAAQ;AACZ,IAAI,aAAa;AACjB,IAAI,iBAAiB;AACrB,IAAI,sBAAsB;AAE1B,SAAS,eAAe,UAAQ;AAC9B,KAAIA,aAAW,UAAW,QAAO;AACjC,QAAO;;AAGT,SAAS,UAAU,QAAQ,OAAO;AAChC,KAAI,OAAO,KAAK,EAAE;AAEhB,QAAM,cAAc;AACpB,MAAI,MAAM,YAAY,OAAO,MAAM,WAAW,CAE5C,QAAO;OACF;AACL,SAAM,WAAW;AACjB,SAAM,SAAS;;AAGjB,MAAI,OAAO,MAAM,UAAU,EAAE;AAC3B,SAAM,YAAY;AAClB,SAAM,cAAc;AACpB,UAAO;;EAGT,IAAI;EACJ,IAAI,iBAAiB;AACrB,OAAK,QAAQ,OAAO,MAAM,qBAAqB,MAC1C,iBAAiB,UAAU,QAAQ,OAAO,MAAM,cAAc,GAAG;AACpE,SAAM,YAAY;AAClB,SAAM,WAAW;AACjB,SAAM,iBAAiB;AACvB,SAAM,SAAS,MAAM;AACrB,UAAO;;AAKT,MAAI,MAAM,cAAc,QAAQ,OAAO,MAAM,OAAO,GAAG;AACrD,SAAM,WAAW;AACjB,SAAM,iBAAiB;AACvB,SAAM,SAAS,MAAM;AACrB,UAAO;;AAGT,QAAM,YAAY;AAClB,SAAO,WAAW;AAClB,SAAO;;AAGT,KAAI,MAAM,aAAa;AACrB,MAAI,OAAO,MAAM,MAAM,CAAE,QAAO;AAChC,MAAI,OAAO,MAAM,WAAW,CAAE,QAAO;AACrC,SAAO,WAAW;AAClB,SAAO;;AAGT,KAAI,MAAM,UAAU;EAClB,IAAI,QAAQ,eAAe,MAAM,OAAO;AAExC,MAAI,MAAM,gBAAgB;AACxB,OAAI,OAAO,MAAM,eAAe,CAAE,QAAO,QAAQ;AACjD,OAAI,OAAO,MAAM,oBAAoB,CAAE,QAAO;;AAEhD,SAAO,WAAW;AAClB,SAAO;;AAGT,QAAO,WAAW;AAClB,QAAO;;AAGT,MAAa,OAAO;CAClB,MAAM;CACN,YAAY,WAAW;AACrB,SAAO;GAEL,aAAa;GAEb,UAAU;GAEV,gBAAgB;GAEhB,QAAQ;GAER,WAAW;GACZ;;CAEH,OAAO;CACP,WAAW,SAAS,OAAO;AACzB,QAAM,YAAY,MAAM,cAAc,MAAM,WAAW;;CAEzD,cAAc,EACZ,cAAc,QAAQ,OAAO,eAAe,EAC7C;CACF"}