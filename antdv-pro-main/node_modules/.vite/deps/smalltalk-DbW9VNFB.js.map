{"version":3,"file":"smalltalk-DbW9VNFB.js","names":[],"sources":["../../@codemirror/legacy-modes/mode/smalltalk.js"],"sourcesContent":["var specialChars = /[+\\-\\/\\\\*~<>=@%|&?!.,:;^]/;\nvar keywords = /true|false|nil|self|super|thisContext/;\n\nvar Context = function(tokenizer, parent) {\n  this.next = tokenizer;\n  this.parent = parent;\n};\n\nvar Token = function(name, context, eos) {\n  this.name = name;\n  this.context = context;\n  this.eos = eos;\n};\n\nvar State = function() {\n  this.context = new Context(next, null);\n  this.expectVariable = true;\n  this.indentation = 0;\n  this.userIndentationDelta = 0;\n};\n\nState.prototype.userIndent = function(indentation, indentUnit) {\n  this.userIndentationDelta = indentation > 0 ? (indentation / indentUnit - this.indentation) : 0;\n};\n\nvar next = function(stream, context, state) {\n  var token = new Token(null, context, false);\n  var aChar = stream.next();\n\n  if (aChar === '\"') {\n    token = nextComment(stream, new Context(nextComment, context));\n\n  } else if (aChar === '\\'') {\n    token = nextString(stream, new Context(nextString, context));\n\n  } else if (aChar === '#') {\n    if (stream.peek() === '\\'') {\n      stream.next();\n      token = nextSymbol(stream, new Context(nextSymbol, context));\n    } else {\n      if (stream.eatWhile(/[^\\s.{}\\[\\]()]/))\n        token.name = 'string.special';\n      else\n        token.name = 'meta';\n    }\n\n  } else if (aChar === '$') {\n    if (stream.next() === '<') {\n      stream.eatWhile(/[^\\s>]/);\n      stream.next();\n    }\n    token.name = 'string.special';\n\n  } else if (aChar === '|' && state.expectVariable) {\n    token.context = new Context(nextTemporaries, context);\n\n  } else if (/[\\[\\]{}()]/.test(aChar)) {\n    token.name = 'bracket';\n    token.eos = /[\\[{(]/.test(aChar);\n\n    if (aChar === '[') {\n      state.indentation++;\n    } else if (aChar === ']') {\n      state.indentation = Math.max(0, state.indentation - 1);\n    }\n\n  } else if (specialChars.test(aChar)) {\n    stream.eatWhile(specialChars);\n    token.name = 'operator';\n    token.eos = aChar !== ';'; // ; cascaded message expression\n\n  } else if (/\\d/.test(aChar)) {\n    stream.eatWhile(/[\\w\\d]/);\n    token.name = 'number';\n\n  } else if (/[\\w_]/.test(aChar)) {\n    stream.eatWhile(/[\\w\\d_]/);\n    token.name = state.expectVariable ? (keywords.test(stream.current()) ? 'keyword' : 'variable') : null;\n\n  } else {\n    token.eos = state.expectVariable;\n  }\n\n  return token;\n};\n\nvar nextComment = function(stream, context) {\n  stream.eatWhile(/[^\"]/);\n  return new Token('comment', stream.eat('\"') ? context.parent : context, true);\n};\n\nvar nextString = function(stream, context) {\n  stream.eatWhile(/[^']/);\n  return new Token('string', stream.eat('\\'') ? context.parent : context, false);\n};\n\nvar nextSymbol = function(stream, context) {\n  stream.eatWhile(/[^']/);\n  return new Token('string.special', stream.eat('\\'') ? context.parent : context, false);\n};\n\nvar nextTemporaries = function(stream, context) {\n  var token = new Token(null, context, false);\n  var aChar = stream.next();\n\n  if (aChar === '|') {\n    token.context = context.parent;\n    token.eos = true;\n\n  } else {\n    stream.eatWhile(/[^|]/);\n    token.name = 'variable';\n  }\n\n  return token;\n};\n\nexport const smalltalk = {\n  name: \"smalltalk\",\n\n  startState: function() {\n    return new State;\n  },\n\n  token: function(stream, state) {\n    state.userIndent(stream.indentation(), stream.indentUnit);\n\n    if (stream.eatSpace()) {\n      return null;\n    }\n\n    var token = state.context.next(stream, state.context, state);\n    state.context = token.context;\n    state.expectVariable = token.eos;\n\n    return token.name;\n  },\n\n  blankLine: function(state, indentUnit) {\n    state.userIndent(0, indentUnit);\n  },\n\n  indent: function(state, textAfter, cx) {\n    var i = state.context.next === next && textAfter && textAfter.charAt(0) === ']' ? -1 : state.userIndentationDelta;\n    return (state.indentation + i) * cx.unit;\n  },\n\n  languageData: {\n    indentOnInput: /^\\s*\\]$/\n  }\n}\n"],"mappings":"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"}