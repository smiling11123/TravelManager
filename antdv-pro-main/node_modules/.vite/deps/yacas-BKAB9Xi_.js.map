{"version":3,"file":"yacas-BKAB9Xi_.js","names":["words"],"sources":["../../@codemirror/legacy-modes/mode/yacas.js"],"sourcesContent":["function words(str) {\n  var obj = {}, words = str.split(\" \");\n  for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n  return obj;\n}\n\nvar bodiedOps = words(\"Assert BackQuote D Defun Deriv For ForEach FromFile \" +\n                      \"FromString Function Integrate InverseTaylor Limit \" +\n                      \"LocalSymbols Macro MacroRule MacroRulePattern \" +\n                      \"NIntegrate Rule RulePattern Subst TD TExplicitSum \" +\n                      \"TSum Taylor Taylor1 Taylor2 Taylor3 ToFile \" +\n                      \"ToStdout ToString TraceRule Until While\");\n\n// patterns\nvar pFloatForm  = \"(?:(?:\\\\.\\\\d+|\\\\d+\\\\.\\\\d*|\\\\d+)(?:[eE][+-]?\\\\d+)?)\";\nvar pIdentifier = \"(?:[a-zA-Z\\\\$'][a-zA-Z0-9\\\\$']*)\";\n\n// regular expressions\nvar reFloatForm    = new RegExp(pFloatForm);\nvar reIdentifier   = new RegExp(pIdentifier);\nvar rePattern      = new RegExp(pIdentifier + \"?_\" + pIdentifier);\nvar reFunctionLike = new RegExp(pIdentifier + \"\\\\s*\\\\(\");\n\nfunction tokenBase(stream, state) {\n  var ch;\n\n  // get next character\n  ch = stream.next();\n\n  // string\n  if (ch === '\"') {\n    state.tokenize = tokenString;\n    return state.tokenize(stream, state);\n  }\n\n  // comment\n  if (ch === '/') {\n    if (stream.eat('*')) {\n      state.tokenize = tokenComment;\n      return state.tokenize(stream, state);\n    }\n    if (stream.eat(\"/\")) {\n      stream.skipToEnd();\n      return \"comment\";\n    }\n  }\n\n  // go back one character\n  stream.backUp(1);\n\n  // update scope info\n  var m = stream.match(/^(\\w+)\\s*\\(/, false);\n  if (m !== null && bodiedOps.hasOwnProperty(m[1]))\n    state.scopes.push('bodied');\n\n  var scope = currentScope(state);\n\n  if (scope === 'bodied' && ch === '[')\n    state.scopes.pop();\n\n  if (ch === '[' || ch === '{' || ch === '(')\n    state.scopes.push(ch);\n\n  scope = currentScope(state);\n\n  if (scope === '[' && ch === ']' ||\n      scope === '{' && ch === '}' ||\n      scope === '(' && ch === ')')\n    state.scopes.pop();\n\n  if (ch === ';') {\n    while (scope === 'bodied') {\n      state.scopes.pop();\n      scope = currentScope(state);\n    }\n  }\n\n  // look for ordered rules\n  if (stream.match(/\\d+ *#/, true, false)) {\n    return 'qualifier';\n  }\n\n  // look for numbers\n  if (stream.match(reFloatForm, true, false)) {\n    return 'number';\n  }\n\n  // look for placeholders\n  if (stream.match(rePattern, true, false)) {\n    return 'variableName.special';\n  }\n\n  // match all braces separately\n  if (stream.match(/(?:\\[|\\]|{|}|\\(|\\))/, true, false)) {\n    return 'bracket';\n  }\n\n  // literals looking like function calls\n  if (stream.match(reFunctionLike, true, false)) {\n    stream.backUp(1);\n    return 'variableName.function';\n  }\n\n  // all other identifiers\n  if (stream.match(reIdentifier, true, false)) {\n    return 'variable';\n  }\n\n  // operators; note that operators like @@ or /; are matched separately for each symbol.\n  if (stream.match(/(?:\\\\|\\+|\\-|\\*|\\/|,|;|\\.|:|@|~|=|>|<|&|\\||_|`|'|\\^|\\?|!|%|#)/, true, false)) {\n    return 'operator';\n  }\n\n  // everything else is an error\n  return 'error';\n}\n\nfunction tokenString(stream, state) {\n  var next, end = false, escaped = false;\n  while ((next = stream.next()) != null) {\n    if (next === '\"' && !escaped) {\n      end = true;\n      break;\n    }\n    escaped = !escaped && next === '\\\\';\n  }\n  if (end && !escaped) {\n    state.tokenize = tokenBase;\n  }\n  return 'string';\n};\n\nfunction tokenComment(stream, state) {\n  var prev, next;\n  while((next = stream.next()) != null) {\n    if (prev === '*' && next === '/') {\n      state.tokenize = tokenBase;\n      break;\n    }\n    prev = next;\n  }\n  return 'comment';\n}\n\nfunction currentScope(state) {\n  var scope = null;\n  if (state.scopes.length > 0)\n    scope = state.scopes[state.scopes.length - 1];\n  return scope;\n}\n\nexport const yacas = {\n  name: \"yacas\",\n  startState: function() {\n    return {\n      tokenize: tokenBase,\n      scopes: []\n    };\n  },\n  token: function(stream, state) {\n    if (stream.eatSpace()) return null;\n    return state.tokenize(stream, state);\n  },\n  indent: function(state, textAfter, cx) {\n    if (state.tokenize !== tokenBase && state.tokenize !== null)\n      return null;\n\n    var delta = 0;\n    if (textAfter === ']' || textAfter === '];' ||\n        textAfter === '}' || textAfter === '};' ||\n        textAfter === ');')\n      delta = -1;\n\n    return (state.scopes.length + delta) * cx.unit;\n  },\n\n  languageData: {\n    electricInput: /[{}\\[\\]()\\;]/,\n    commentTokens: {line: \"//\", block: {open: \"/*\", close: \"*/\"}}\n  }\n};\n"],"mappings":"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"}